"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3485],{3485:(O,m,a)=>{a.r(m),a.d(m,{LoginPageModule:()=>b});var h=a(177),d=a(4341),l=a(8974),p=a(1007),c=a(467),v=a(3873),e=a(6276),C=a(4666);let f=(()=>{var o;class s{constructor(n,i,t){this.router=n,this.alertController=i,this.userService=t,this.error_msg="",this.disable=!1,this.loginForm={login:"",password:""},this.loginData="",this.password=""}ngOnInit(){}ionViewDidEnter(){var n=this;return(0,c.A)(function*(){(yield n.userService.isLogged())?n.userService.logOut():(yield n.userService.isWaitingForCode())&&n.router.navigate(["/code"])})()}login(){var n=this;return(0,c.A)(function*(){n.userService.login(n.loginForm.login,n.loginForm.password).subscribe(function(){var i=(0,c.A)(function*(t){let r;try{r=v.K.populate(t),console.log("USER2: "+r)}catch(u){return void(yield(yield n.alertController.create({message:u,buttons:["OK"]})).present())}r.isActive()?(r.setLogged(!0),n.userService.saveUserKeyStore(),n.userService.saveUserStore(r),n.router.navigate(r.codeValidated?["/menu"]:["/code"])):yield(yield n.alertController.create({message:"El usuario se encuentra en proceso de eliminaci\xf3n de la aplicaci\xf3n",buttons:["OK"]})).present()});return function(t){return i.apply(this,arguments)}}(),function(){var i=(0,c.A)(function*(t){yield(yield n.alertController.create({message:"Email y/o contrase\xf1a incorrectos",buttons:["OK"]})).present()});return function(t){return i.apply(this,arguments)}}())})()}goToRegister(){this.router.navigate(["/register"])}sendPasswordSMS(){var n=this;return(0,c.A)(function*(){""!==n.loginForm.login?yield(yield n.alertController.create({message:"Vas a reiniciar tu contrase\xf1a, \xbfest\xe1s seguro?",buttons:[{text:"OK",handler:()=>{console.log(n.loginForm.login),n.userService.sendPassword(n.loginForm.login).subscribe((0,c.A)(function*(){yield(yield n.alertController.create({message:"Nueva contrase\xf1a enviada a tu correo electr\xf3nico. Por favor revisa tu bandeja de entrada.",buttons:["OK"]})).present()}),function(){var t=(0,c.A)(function*(r){let u="No se pudo enviar el c\xf3digo de verificaci\xf3n, int\xe9ntalo de nuevo m\xe1s tarde";r.error.toLowerCase().indexOf("found")>-1?u="El email introducido no existe en la app":r.error.toLowerCase().indexOf("unique")>-1&&(u="Hay un problema con el email proporcionado. Contacta con el administrador."),yield(yield n.alertController.create({message:u,buttons:["OK"]})).present()});return function(r){return t.apply(this,arguments)}}())}},{text:"Cancelar"}]})).present():yield(yield n.alertController.create({message:"El email no puede estar vac\xedo",buttons:["OK"]})).present()})()}}return(o=s).\u0275fac=function(n){return new(n||o)(e.rXU(p.Ix),e.rXU(l.hG),e.rXU(C.D))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-login"]],decls:26,vars:3,consts:[[3,"fullscreen"],["padding-vertical","",1,"icontent"],[1,"title"],["size","12"],[1,"ion-text-center","padding"],["color","light","placeholder","Email","type","text",1,"custom",3,"ngModel","ngModelChange"],["color","light","placeholder","Contrase\xf1a","type","password",1,"custom",3,"ngModel","ngModelChange"],["color","light","size","large","expand","block","shape","round",3,"click"],[2,"color","#E30025","font-weight","bold","font-size","22px"],["color","medium","size","large","expand","block","shape","round",3,"click"],[1,"text"],[1,"link",3,"click"]],template:function(n,i){1&n&&(e.j41(0,"ion-content",0)(1,"div",1)(2,"h3",2),e.EFF(3,"ENTRADA A LA APP"),e.k0s(),e.j41(4,"ion-row")(5,"ion-col",3)(6,"ion-item",4)(7,"ion-input",5),e.bIt("ngModelChange",function(r){return i.loginForm.login=r}),e.k0s()()(),e.j41(8,"ion-col",3)(9,"ion-item",4)(10,"ion-input",6),e.bIt("ngModelChange",function(r){return i.loginForm.password=r}),e.k0s()()()(),e.j41(11,"ion-row")(12,"ion-col",3)(13,"ion-button",7),e.bIt("click",function(){return i.login()}),e.j41(14,"span",8),e.EFF(15,"ENTRAR"),e.k0s()()()(),e.j41(16,"ion-row")(17,"ion-col",3)(18,"ion-button",9),e.bIt("click",function(){return i.goToRegister()}),e.j41(19,"span",8),e.EFF(20,"CREAR CUENTA"),e.k0s()()()(),e.j41(21,"div",10),e.EFF(22," \xbfNo recuerdas tu contrase\xf1a? "),e.j41(23,"span",11),e.bIt("click",function(){return i.sendPasswordSMS()}),e.EFF(24,"Pulsa aqu\xed"),e.k0s(),e.EFF(25," y te enviaremos un email con una contrase\xf1a temporal. Despu\xe9s de loguearte es conveniente entrar a tus datos de usuario para modificarla "),e.k0s()()()),2&n&&(e.Y8G("fullscreen",!0),e.R7$(7),e.Y8G("ngModel",i.loginForm.login),e.R7$(3),e.Y8G("ngModel",i.loginForm.password))},dependencies:[d.BC,d.vS,l.Jm,l.hU,l.W9,l.$w,l.uz,l.ln,l.Gw],styles:["ion-content[_ngcontent-%COMP%]{--background: #E30025}.icontent[_ngcontent-%COMP%]{padding:15px}.title[_ngcontent-%COMP%]{text-align:center;color:#fff}.text[_ngcontent-%COMP%]{color:#fff;width:90%;margin:auto;font-size:1em}label[_ngcontent-%COMP%]{color:#fff;margin-bottom:4px;font-size:1.2em}.logoholder[_ngcontent-%COMP%]{text-align:center;margin-left:auto;margin-right:auto}.logoholder[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#a5a5a5!important}ion-item[_ngcontent-%COMP%]{border-radius:35px!important;box-shadow:0 0 30px #0000001a}ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#e30025!important}ion-input[_ngcontent-%COMP%]{background-color:#fff;width:90vw;margin:10px;padding-top:10px;padding-bottom:10px}ion-input.custom[_ngcontent-%COMP%]{font-size:22px;font-weight:700;--placeholder-color: #000;--placeholder-opacity: .4}.loginbtn[_ngcontent-%COMP%]{border-radius:25px;color:#fff!important;font-size:1.5em;height:50px;background-color:#cc0020}.registerbtn[_ngcontent-%COMP%]{border-radius:25px;color:#cc0020!important;font-size:1.5em;height:50px;margin-top:10px}.registerbtn-dark[_ngcontent-%COMP%]{background-color:#ccc}.link[_ngcontent-%COMP%]{text-decoration:underline}"]}),s})();const P=[{path:"inicio",component:f}];let M=(()=>{var o;class s{}return(o=s).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[p.iI.forChild(P),p.iI]}),s})();const y=[{path:"",component:f}];let b=(()=>{var o;class s{}return(o=s).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[h.MD,d.YN,d.X1,l.bv,M,p.iI.forChild(y)]}),s})()}}]);